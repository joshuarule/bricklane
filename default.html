{% capture content %}

{% capture json %}
{
{% for page in site.pages %}
  {% if page.title == "Tour Dates" %}
    "artists": [
    {% for page in page.pages %}
      {
        "name" : "{{page.title}}",
        "events" : [
        {% for post in page.posts %}
          {
            "title":  {{post.title | json}},
            "posted": "{{post.date | date: "%D"}}",
            "date" : "{{post.date | date: "%B %-d" }}",
            "city": "{{post.meta['city']}}",
            "url": "{{post.url}}"
          }{% unless forloop.last %},{% endunless %}
        {% endfor %}
        ]
      }{% unless forloop.last %},{% endunless %}
    {% endfor %}
    ]
  {% endif %}
{% endfor %}
}
{% endcapture %}

<section class="hero">
	<div class="hero-mobile">  
		<div class="hero-image">
			<img src="http://placekitten.com/g/1000/360" alt="">
		</div>			
		<h1 class="hero-title">Mayors of Liberty<br><span>Dream On</span></h1>
	</div>
	<p class="hero-subtitle">Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
</section>

<section class="section">	
	<h2 class="section-header">New Releases</h2>
	<div class="section-content">
		<ul class="split-2">
			{% include 'includes/item' %}
			{% include 'includes/item' %}
			{% include 'includes/item' %}
			{% include 'includes/item' %}
		</ul>
	</div>
</section>

<section class="section">	
	<h2 class="section-header">Tweets</h2>
	<div class="section-content">		
		<ul id="tweets" class="split-2">
		</ul>
	</div>
</section>

<section class="section">	
	<h2 class="section-header">News</h2>
	<div class="section-content">		
		<ul class="split-2">			
			<li>
				<img class="item-image" src="http://placekitten.com/g/300/200" alt="">
				<div class="article-date">
					June 12
				</div>
				<p>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
				<p><a href="#">Like</a> | <a href="#">23 people</a> like this.</p>
			</li>		
			<li>
				<img class="item-image" src="http://placekitten.com/g/300/200" alt="">
				<div class="article-date">
					June 12
				</div>
				<p>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Praesent commodo cursus magna, vel scelerisque nisl consectetur et. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
				<p><a href="#">Like</a> | <a href="#">23 people</a> like this.</p>
			</li>
		</ul>
	</div>
</section>

<section class="section">	
	<h2 class="section-header">Touring Now</h2>
	<div class="section-content">
		<div class="split-2">
		<ul id="events-l"></ul>
		<ul id="events-r"></ul>
		</div>
	</div>
</section>

<section class="section"> 
	<h2 class="section-header">Videos</h2>
	<div class="section-content">
		<ul id="divPlaylistContainer" class="split-2">
		
		</div>

		<div id="tmplVideoItem" style="display:none;">
			<li>
				<div class="video-responsive">
				  <iframe src="{videoSrc}?&showinfo=0"  width="560" height="315" frameborder="0" allowfullscreen></iframe>
			  </div>
			  <a href="{videoUrl}">{title}</a>
			  <p>By <a href="artists/{artist}">{channelTitle}</a> - {publishedAt} - {viewCount} views</p>
			</lid>
		</div>
	</div>
</section>

<script> 

	// 
	// Tour Dates Array
	// 

  // sorts the array by date

  var custom_sort = function(a, b) {
    return new Date(a.posted).getTime() - new Date(b.posted).getTime();
  }

  var tourDates = {{ json | strip_newlines | replace:'  ','' }},
  arr = [],
  // counter to set the array id #
  k = 0;

  // finds number of artists

  var artistsNum = tourDates.artists.length;

  for (var i = 0; i < artistsNum; i++){
    var artistName = tourDates.artists[i].name;
    var artistEvents = tourDates.artists[i].events;
    var dates = artistEvents.length;

    for (var j = 0; j < dates; j++ ) {
      k++;
      // add items to array
      arr.push({"id": k, "artist": artistName, "posted": artistEvents[j].posted, "date": artistEvents[j].date, "venue": artistEvents[j].title, "city": artistEvents[j].city, "url": artistEvents[j].url });
    }
  }

  // call sort function on arr
  arr.sort(custom_sort);

  // set id to place first column of items
  var list = $("#events-l");
  var arrLength = arr.length;

  for(var l = 0; l < 8 && arrLength; l++) {
  	if (l > 3 ) {
  		list = $("#events-r");
  	}
    list.append('<li><p><a href="' + arr[l].url + '"><span class="event-artist">' + arr[l].artist + '</span>' + 
                ' â€¢ <span class="event-date">' + arr[l].date + '</span><br>' +
                '<span class="event-venue">' + arr[l].venue + '</span>' + 
                '<span class="event-city">' + arr[l].city + '</span>' +
                '</a></p></li>');
  }
</script>

{% endcapture %}

{% include 'layouts/default' %}


